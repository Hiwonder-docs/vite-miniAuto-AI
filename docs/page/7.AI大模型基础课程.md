# 7.基础课程


<p id ="anther1.1"></p>

## 7.1 **WonderLLM介绍**

### 7.1.1 模块介绍

WonderLLM是一款AI大模型模块，内置ESP32-S3高性能芯片，集成了200W像素高清摄像头、麦克风、高清显示屏、扬声器、CI1302语音识别芯片，深度融合了文本、语音、视觉等多种模型。

该模块操作简易，常与机器人搭配使用，使机器人如同装上一颗"超级大脑”，能够深层次理解用户指令，赋予其卓越的感知、推理与行动能力，从而打造灵活自然的人机交互体验!

<img src="..\_static\media\chapter_7\section_1\media\image1.png"    class="common_img"  style="width:400px"/>




### 7.1.2 工作原理

1. 模块采用口令模式唤醒，用户需要说出唤醒词来唤醒WonderLLM，激活后才可以进行人机交互。默认识别的语言为英文，英文唤醒关键词为**“Hello Hiwonder”**，若需切换为中文识别，需要烧录中文识别固件，切换至中文固件后，中文唤醒关键词为**“小幻小幻”**。

2. 模块识别到唤醒词，蜂鸣器鸣响一声，随后即可开始与用户交互。模块支持中英文任一语种交流，并会根据用户发言，自行识别语种并切换。若1分钟内无识别到语音，则会进入休眠模式，再次使用需要重新唤醒。

3. 模块支持唤醒词修改和自定义词条，可前往“[**7.10 唤醒词修改**](#p7-10)”学习如何修改。

4. 教程均以中文识别为例，如需烧录英文固件，可前往[**“7.11 固件下载”**](#_7-11-固件下载)内查看固件烧录教程。

   

### 7.1.3 注意事项

1. 请使用5V电压供电，否则会损坏模块。

2. 使用场景应安静，嘈杂的环境会影响识别效果。

3. 说词条时，声音要洪亮且语速不宜过快，建议与模块之间保持在5米以内。

   

### 7.1.4 硬件接口说明

<img src="..\_static\media\chapter_7\section_1\media\image2.png"     class="common_img"  style="width:500px"/>


<table>
<tr><td>序号</td><td>说明</td></tr>
<tr><td>1</td><td>Type-C接口（上方），用于为ESP32-S3芯片烧录程序固件</td></tr>
<tr><td>2</td><td>Type-C接口（下方），用于为CI1302芯片烧录语音识别固件</td></tr>
<tr><td>3</td><td>4-PIN IIC通信接口，可用于二次开发</td></tr>
<tr><td>4</td><td>可触摸电容屏，用于显示画面/调节音量</td></tr>
<tr><td>5</td><td>按键（左），用于模块重启、切换表情/聊天模式</td></tr>
<tr><td>6</td><td>高清摄像头，可捕获实时图像</td></tr>
<tr><td>7</td><td>按键（右），用于模块重启、网络配置、交互控制</td></tr>
</table>


### 7.1.5 设备开机

1)  模块支持如下接口供电：**①Type-C接口（上方）**、**②Type-C接口（下方）**  **③4-PIN IIC通信接口**，用户可任选一处接口，接入外部供电设备，模块供电自动开机。

2. 模块上电后，若为第一次使用，则画面首先显示**WIFI名称**及**浏览器配网网址**并伴随语音播报，用户需要按照[“7.2 联网及配置”](#_7-2-联网及配置)完成模块设备配网。

<img src="..\_static\media\chapter_7\section_1\media\image3.png"    class="common_img"  style="width:400px"/>


3. 模块配网完成后需要完成与平台智能体绑定，模块画面显示**设备ID**及**设备绑定平台网址**并伴随语音播报绑定验证码，用户需要按照[“**7.2 联网及配置**”](#_7-2-联网及配置)完成模块设备绑定。

<img src="..\_static\media\chapter_7\section_1\media\image4.png"    class="common_img"  style="width:400px"/>


4. 模块上电后，若已完成设备绑定，屏幕显示白色环形滚动条，此时模块正在根据内部存储WIFI信息自行联网。若模块联网失败，则画面显示**设备热点名**及**设备访问网址**并伴随语音播报，用户需要按照[“**7.2 联网及配置**”](#_7-2-联网及配置)再次配置当前环境可用的新WIFI连接信息。

<img src="..\_static\media\chapter_7\section_1\media\image5.png"    class="common_img"  style="width:400px"/>


5. 模块上电后，若已完成设备绑定，且配置WIFI连接信息当前环境可用，屏幕白色环形滚动条加载一段时间后网络连接成功，跳转至模块表情显示界面。此时模块一切配置正常，用户唤醒模块后即可开始人机交互。

<img src="..\_static\media\chapter_7\section_1\media\image1.png"  style="width:400px"  class="common_img"/>




### 7.1.6 设备重启

1)  模块支持上电后手动重启模块，用户可通过：**①长按左侧按键**、 **②长按右侧按键**任意一种方式，在非断电情况下重启模块。

2)  当模块检测到用户通过长按按键发来的重启指令，会自行关机重启，此时可见屏幕直接熄灭，此时用户可松开按键，后续模块会自行开机。

3)  若用户通过长按右侧按键重启，若模块重新开机后尚未松开按键，可能导致模块误判断进入配网模式（详见**[“7.2 联网及配置”](#anther1.2)**），带来不必要的麻烦，因此推荐通过长按左侧按键实现模块重启功能。


<p id ="anther1.2"></p>

## 7.2 **联网及配置**

### 7.2.1 模块联网

* **操作步骤**

1. 模块上电后则开始联网操作，当出现如下情况，会导致模块进入配网模式：**①模块初次使用/重新烧录固件，内存未保存可用WIFI连接信息** 、**②当前环境中，不存在与存储WIFI连接信息匹配的热点** 、**③用户手动操作进入**。
2. 此时画面显示**设备热点名**及**设备访问网址**并伴随语音播报，大模型模块会开启自带热点，供用户连接配置。不同设备热点名不同，格式统一为**“Robot-xxxx”**，下文以热点Robot-B7B9为例进行讲解。

<img src="..\_static\media\chapter_7\section_1\media\image3.png"    class="common_img"  style="width:400px"/>

3. 用户可使用电脑或手机搜索对应热点并连接（该热点无密码）。

<img src="..\_static\media\chapter_7\section_2\media\image1.png"     class="common_img"/>

<img src="..\_static\media\chapter_7\section_2\media\image2.png"     class="common_img"/>

4. 打开任意浏览器，进入如下网址：http://192.168.4.1,也可点击[<u>网络配置</u>](http://192.168.4.1/)超链接直接访问。

<img src="..\_static\media\chapter_7\section_2\media\image3.png"     class="common_img"/>

5. 用户可点击此处切换界面显示语言。

<img src="..\_static\media\chapter_7\section_2\media\image4.png"     class="common_img"/>

6. 用户可在下图①中输入期望模块上电自动连接热点的热点名称，②中输入热点的连接密码。最后点击③中的**“连接”**，模块会尝试根据用户提供的热点连接信息，在当前所处环境寻找匹配的热点并连接。

   <img src="..\_static\media\chapter_7\section_2\media\image5.png"     class="common_img"/>
> [!Note]
>
> * **请不要输入当前环境中不能搜索到的、信号过于微弱的或不支持联网功能的热点。**
> * **若之前模块已保存其他热点的连接信息，新保存的热点连接信息会与之共存。下一次模块上电工作，会按保存顺序依次读取每一条连接信息尝试匹配连接热点。**


7. 在界面中可以找到模块扫描出的当前环境可用热点列表，单击某一项，对应热点的热点名称会自动填入①处位置，更加省时便捷。

   <img src="..\_static\media\chapter_7\section_2\media\image6.png"     class="common_img"/>

8. 若界面出现如下提示，表示当前环境无法找到此热点或连接密码错误，请重新输入。

   <img src="..\_static\media\chapter_7\section_2\media\image7.png"     class="common_img"/>

9. 若界面出现如下提示，表示模块成功找到对应热点并连接成功。模块会自动重启并连接到对应热点。至此模块前置准备步骤均已完成，用户即可按照后续课程文档体验WonderLLM模块各交互玩法。

<img src="..\_static\media\chapter_7\section_2\media\image8.png"     class="common_img"/>

>[!Note]
>**若模块配网完成后屏幕出现“错误:检查新版本失败，将在 xx 秒后重试”提示，可能是由于当前热点不可访问互联网或网络质量不佳，请尝试切换。**



* **手动进入配网模式**

1. WonderLLM模块支持用户手动进入配网模式，以适配客户自主选择模块连接热点的需求。

2. 当模块上电后，长按右侧按键，向模块发出重启指令，模块接收到后屏幕熄灭。此时用户需要继续保持长按，模块重启后开始尝试连接热点，屏幕出现白色环形滚动条，此时模块检测到右侧按键被长按，不再匹配外部热点，直接进入配网模式，此时用户可松开按键。

3. 进入配网模式后，已有的热点配置信息并不会丢失，此时用户可进入网络配置页面，也可短按右侧按键，退出配网模式。

4. 退出配网模式后模块会继续根据已保存的热点信息尝试连接，若模块无法连接到外部热点，会重新进入配网模式。

   

* **管理已保存连接配置(选看)**

1. 模块处于配网模式，用户连接模块热点进入网络配置界面后,可以看到已保存的全部热点连接配置信息列表（若用户之前已经配置过热点连接信息），如下图：

   <img src="..\_static\media\chapter_7\section_2\media\image9.png"     class="common_img"/>

2. 用户可点击任意一条已保存的热点连接信息对应的<img src="..\_static\media\chapter_7\section_2\media\image10.png" style="width:70px" class="inline-icon"/>图标，将其删除，也可点击<img src="..\_static\media\chapter_7\section_2\media\image11.png" style="width:70px" class="inline-icon" />图标提升其在模块配网时匹配次序优先级(列表由上到下优先级递减)。

   

### 7.2.2 设备绑定

1. 模块上电完成配网后，若为第一次使用，则画面显示**6位设备ID**及**设备绑定平台网址**并伴随语音播报，用户需按下文教程完成模块设备与平台智能体绑定。

<img src="..\_static\media\chapter_7\section_1\media\image4.png"    class="common_img"  style="width:400px"/>

2. 打开任意浏览器，进入如下网址：xiaozhi.me,也可点击[<u>小智 AI 聊天机器人</u>](https://xiaozhi.me/)超链接直接访问。

<img src="..\_static\media\chapter_7\section_2\media\image12.png"     class="common_img"/>

3. 用户可点击此处切换界面显示语言。

<img src="..\_static\media\chapter_7\section_2\media\image13.png"     class="common_img"/>

4. 点击**控制台**，进入小智AI智能体管理平台。

<img src="..\_static\media\chapter_7\section_2\media\image14.png"     class="common_img"/>

5. 若用户初次登录，需要使用注册平台账号，账号注册流程此处不再展开。完成注册登录后，进入如下界面,平台默认生成一个智能体，稍后我们将在此基础上补充配置，并将设备ID绑定至此智能体。

<img src="..\_static\media\chapter_7\section_2\media\image15.png"     class="common_img"/>

6. 点击**“配置角色”**。

<img src="..\_static\media\chapter_7\section_2\media\image16.png"     class="common_img"/>

7. 在配置界面中，①处助手昵称填写“**小幻**”(**不推荐修改，如需修改还需参照[7.10 唤醒词修改](#_7-10-唤醒词修改)同步修改模块唤醒词**)，②处对话语言、角色音声可根据自身需求选择，③处角色介绍可使用默认模板或自定义(**此处推荐使用我司提供的如下角色介绍，以便智能体互动时更好适应后续玩法对话**)。

```
[角色设定]  
你是{{assistant_name}}，我的智能管家， 你是有实体的，能完成各种任务，遵循各种指令。  
[核心特征]  

- 深刻理解我的用意  

- 回答简短，不罗嗦  

- 不要做任何记忆  

- 给出合适的建议并执行
```

<img src="..\_static\media\chapter_7\section_2\media\image17.png"     class="common_img"/>

8. 记忆体类型选**“无记忆”**，语言模型项推荐选择“**DeepSeek V3(性格丰富)**”，高级设置项可调节更多详细工作参数，此处保持默认设置，最后点击**"保存"**即可。

   <img src="..\_static\media\chapter_7\section_2\media\image18.png"     class="common_img"/>

9. 保存成功后，返回上一级界面， 点击“**添加设备**” 。

<img src="..\_static\media\chapter_7\section_2\media\image19.png"     class="common_img"/>

10. 在弹窗输入6位设备ID，点击确定，即完成设备绑定 。

<img src="..\_static\media\chapter_7\section_2\media\image20.png"     class="common_img"/>

11) 若绑定成功，可在页面观察到“**添加设备成功**”提示，如下图 。选择“**开源版**”，点击“**开始使用**”。

<img src="..\_static\media\chapter_7\section_2/media/image21.png"     class="common_img"/>


<p id ="anther1.3"></p>


## 7.3 **音量控制**

>[!note]
>**在进行本节学习前，请确保已根据[“7.1 WonderLLM介绍”](#_7-1-wonderllm介绍)、[“7.2 联网及配置”](#_7-2-联网及配置)打开模块并完成WIFI、智能体配置。**

在与WonderLLM大模型模块交互时，支持手动设置模块发言音量，以达到最佳的交互体验。



### 7.3.1 屏幕触摸控制音量

1)  模块上电并成功连接到外部热点后，可在两种界面下触摸屏幕调整模块音量：**①表情界面**  **②聊天界面**

>[!note]
>
>**表情界面即为模块上电并联网成功后出现的界面；聊天界面为用户说出唤醒词/短按右侧按键进入的界面，会在[7.4 聊天模式](#_7-4-聊天模式)详细介绍。**

2. 具体操作方法为：将切换至指定界面后，在屏幕任意位置滑动，竖直向上滑动，模块自动增大音量；竖直向下滑动，模块自动减小音量。音量改变幅度取决于屏幕滑动距离，支持多次滑动屏幕调节音量。

>[!note]
>**在WonderLLM发言时改变音量，将会在下一轮发言时生效。**

3. 在滑动屏幕改变音量时，屏幕正上方会显示实时音量数值，下图以在**表情界面**上滑增大音量为例：

   <img src="../_static\media/chapter_7/section_6/media/image1.png" style="width:400px"  class="common_img" />

   

### 7.3.2 语音控制音量(选看)

1)  在与WonderLLM大模型模块交互过程中，可通过下达音量调节命令控制模块调节音量。

2)  具体操作方法为：通过**说出唤醒词/短按右侧按键**进入**聊天界面**，此时模块激活，用户可参考如下表述：**①将音量调至xx（有效范围0-100，只支持整数，也可以表达为百分比）**  **②增大音量(模糊表达，模块自行调整音量)**

>[!note]
>
>* **在WonderLLM发言时改变音量，将会在下一轮发言时生效。**
>
>* **用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可**。

3. 模块识别后，对话框返回需调用的音量调节函数（用户无需关注），之后对话框显示大模型回应语句并同步播报。（回复语句为大模型模块随机生成，仅保证表意恰当）

   <img src="../_static\media/chapter_7/section_6/media/image2.png" style="width:400px"  class="common_img" />

<p id ="anther1.4"></p>

## 7.4 **聊天模式**

>[!note]
>
>**在进行本节学习前，请确保已根据[“7.1 WonderLLM介绍”](#_7-1-wonderllm介绍)、[“7.2 联网及配置”](#_7-2-联网及配置)打开模块并完成WIFI、智能体配置。**

### 7.4.1 模式概述

1. 在当前模式下，模块会侦听并理解用户发言，进行恰当回复。
2. 模块若干模式的切换关系如下图。可将**进入聊天模式**的操作总结如下：在其他任意模式下，通过**说出唤醒词/短按右侧按键**(详见[**7.4.2 操作说明**](#_7-4-2-操作说明))， 即可进入聊天模式。

<img src="../_static\media/chapter_7/section_5/media/image1.png" class="common_img"  style="width:500px"/>

<p id ="anther1.4.2"></p>

### 7.4.2 操作说明

1. 在完成配网后，模块首先进入表情界面，如下图：

   <img src="..\_static\media\chapter_7\section_1\media\image1.png"    class="common_img"  style="width:400px"/>

2. 用户可以说出指定唤醒词（出厂默认为“**小幻，小幻**”），或短按右侧按键B进入聊天模式，此时可以听到蜂鸣器发出“**叮**”提示音，屏幕切换至**聊天框界面**显示，模块被成功唤醒并开始侦听用户发言。

>[!note]
>
>
>* **如果在表情界面超过20秒没说出唤醒词，模块将进入天气时钟模式（界面如下）。用户可单击屏幕任一位置回到表情模式，此外天气时钟模式同样支持通过说出唤醒词/短按右侧按键进入聊天模式。**
>
>  <img src="../_static\media/chapter_7/section_3/media/image2.png" style="width:500px"  class="common_img"/>

3. 如果以**说出唤醒词方式**进入聊天模式，模块识别到唤醒词后**默认以用户身份发送“你好”**作为对话开场语，大模型会**做出恰当回复**显示在聊天框界面并同步播报(可被人为打断从而快速跳过，具体操作详见[“**7.8 自由聊天**”](#_7-8-自由聊天))，**之后才开始侦听**用户发言。

<img src="../_static\media/chapter_7/section_4/media/image3.png" style="width:500px"  class="common_img"/>

4. 如果以**短按右侧按键方式**进入聊天模式，模块则会**立即开始侦听**用户发言。

<img src="../_static\media/chapter_7/section_4/media/image4.png" style="width:500px"  class="common_img"/>

5. 进入聊天模式，开始人机交互后，用户可以选择让模块**不显示聊天框界面**，而是**持续保持表情界面**，具体操作方式详见[**7.5.2 操作说明**](#_7-5-2-操作说明)。



## 7.5 **表情模式**

>[!note]
>**在进行本节学习前，请确保已根据[“7.1 WonderLLM介绍”](#_7-1-wonderllm介绍)、[“7.2 联网及配置”](#_7-2-联网及配置)打开模块并完成WIFI、智能体配置。**

### 7.5.1 模式概述

1. 在当前模式下，模块会拟态人类表情神态。
2. 模块若干模式的切换关系如下图。可将**进入表情模式**的操作总结如下：**①在天气时钟模式下单击屏幕进入表情模式**  **②在摄像头模式下双击屏幕进入表情模式** **③在聊天模式下(在模块未发言时)短按右侧按键进入表情模式**。

<img src="../_static\media/chapter_7/section_5/media/image1.png" class="common_img"  style="width:500px"/>

<p id ="anther1.5.2"></p>

### 7.5.2 操作说明

1. 在完成配网后，模块首先进入表情模式。

   <img src="../_static\media/chapter_7/section_1/media/image1.png" style="width:400px"  class="common_img" />

   

4. 模块处于表情模式中，用户短按左侧按键，可切换“**聊天模式**”与“**表情模式**”。此时可见屏幕上方显示当前模式字样。（模块默认为“**聊天模式**”）

>[!note]
>
>* **(非常重要)此处切换两个模式，是切换模块” 进入聊天模式，屏幕的显示内容(界面) “。**
>* **在短按左键切换模式期间，模块一直工作在”表情模式“。短按左键切换至”聊天模式“并不会也不能唤醒模块，从而进入真正的聊天模式。**
>* **具体来说，若短按左键将聊天模式下的显示界面切换为”聊天模式“，当用户通过说出唤醒词/短按右侧按键激活模块后并开始交互时，此时模块会显示聊天模式的聊天框界面并显示大模型回复内容；**
>* **若短按左键将聊天模式下的显示界面切换为切换为”表情模式“，当用户通过说出唤醒词/短按右侧按键激活模块后并开始交互时，模块将始终保持在表情界面，并可根据回复内容做出恰当表情拟态。**

<img src="../_static\media/chapter_7/section_5/media/image3.png" style="width:400px"  class="common_img" />



<img src="../_static\media/chapter_7/section_5/media/image4.png" style="width:400px"  class="common_img" />

3. 用户通过短按左侧按键切换至“**表情模式**”（进入聊天模式的屏显内容为表情界面），并通过说出唤醒词/短按右侧按键方式激活模块进入“**聊天模式**”开始人机交互后，模块可根据用户发言，进行表情拟态，主要为以下两类调用方式：**①(描述具体事件，模块在回复时自动做出恰当表情拟态)**  **②给我做个xx的表情吗**

>[!note]
>**用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可。**

4. 用户通过短按左侧按键切换至“**表情模式**”，并通过上文方式进入“**聊天模式**”开始人机交互后，模块可根据用户发言，进行表情拟态，主要为以下两类调用方式：**①(描述具体事件，模块在回复时自动做出恰当表情拟态)**  **②给我做个xx的表情吗**

>[!note]
>**用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可。**



## 7.6 **天气时钟模式**

### 7.6.1 模式概述

1. 在当前模式下，模块会根据设定城市，获取实时气象、时间信息并显示。
2. 模块若干模式的切换关系如下图。可将**进入天气时钟模式**的操作总结如下：**①在表情模式下单击屏幕/20s无操作进入表情模式** ，摄像头模式和聊天模式不支持直接切换至天气时钟模式。

<img src="../_static\media/chapter_7/section_5/media/image1.png" class="common_img"  style="width:500px"/>



### 7.6.2 操作说明

1. 在完成配网后，模块首先进入表情模式，如下图。

<img src="..\_static\media\chapter_7\section_1\media\image1.png"    class="common_img"  style="width:400px"/>

2. 在该模式下无操作20s/单击屏幕任一位置，可切换至天气时钟模式。

<img src="../_static\media/chapter_7/section_3/media/image2.png" style="width:500px"  class="common_img" />

3. 进入天气时钟模式后，如无其他操作，模块将始终保持该模式。

4. 该模式下，模块屏幕会显示如下内容：**①所在地的实时气象信息和未来2天天气预报信息**  **②当前北京时间及日期**  **③所在地城市（出厂默认设定广东深圳市）**。

5. 模块支持修改所在地城市，用户可通过说出唤醒词/短按右侧按键进入聊天界面激活模块，参考如下表述，向WonderLLM模块下达指令：**①修改城市（后续的对话还需指定切换城市）**  **②切换所在地城市到xx市**。模块回复后，天气时钟模式的所在地会同步切换。

>[!note]
>
>**用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可**

<img src="../_static\media/chapter_7/section_5/media/image5.png" style="width:400px"  class="common_img" />

<p id ="anther1.7"></p>

## 7.7 **摄像头模式**

### 7.7.1 模式概述

1. 在当前模式下，模块会调用摄像头持续捕获实时图像并显示。
2. 模块若干模式的切换关系如下图。可将**进入摄像头模式**的操作总结如下：**①在表情模式下双击屏幕进入摄像头模式** ，天气时钟模式和聊天模式不支持直接切换至摄像头模式。

<img src="../_static\media/chapter_7/section_5/media/image1.png" class="common_img"  style="width:500px"/>



### 7.7.2 操作说明

1. 在完成配网后，模块首先进入表情模式，如下图。

<img src="..\_static\media\chapter_7\section_1\media\image1.png"    class="common_img"  style="width:400px"/>

2. 在该模式下。**双击**屏幕任一位置，可切换至摄像头模式。

<img src="../_static\media/chapter_7/section_4/media/image2.png" style="width:400px"  class="common_img" />

3. 在摄像头模式下，模块会调用摄像头**持续捕获**实时图像并显示。如无其他操作，模块将始终保持该模式。

4. 在摄像头模式下，单击屏幕任一位置可触发场景理解功能(详见[“**1.9 场景理解**”](#_7-9-场景理解))。

<p id ="anther1.8"></p>

## 7.8 **自由聊天**

>[!note]
>**在进行本节学习前，请确保已根据[“7.1 WonderLLM介绍”](#_7-1-wonderllm介绍)、[“7.2 联网及配置”](#_7-2-联网及配置)打开模块并完成WIFI、智能体配置。**

### 7.8.1 常规操作说明

1. 在模块上电并配网完成后，用户需要通过**说出唤醒词/短按右侧按键**唤醒模块，进入聊天模式。

2. 用户可自由发言，模块通过联动云端大模型进行理解并做出文字和语音回复。模块具有记忆功能，支持多轮连续对话。

3)  每一轮用户与模块交互对话结束后（包括唤醒WonderLLM后），模块会持续侦听，若连续1分钟内未识别到用户发言，模块自动结束侦听工作，大模型会回复恰当告别语显示在聊天框界面并同步播报。若用户希望继续交互，需重新以“**说出指定唤醒词/短按右侧按键**”方式唤醒模块。

4)  在人机交互对话过程中，用户也可主动结束结束对话，可参考如下表述，向WonderLLM模块下达指令：**①再见**  **②好的，就到这里吧**，模块收到后回复恰当告别语，结束侦听工作。

>[!note]
>**用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可**

5. WonderLLM模块支持语音打断功能，在模块语音发言时（包括：**①模块语音回复用户发言**  **②模块语音向用户问好**  **③模块语音向用户告别**），短按右侧按键，模块立即结束本轮语音发言，转而立刻开始侦听用户下一轮发言。

>[!note]
>**如果在模块未语言发言时短按右侧按键，则会切换至表情模式，此时需要重新唤醒。**

6. WonderLLM模块支持中英双语种识别/发言，用户可参考如下示例表达，直接切换模块工作语言：**①你可以和我说中文吗？**  **②我们可以用英文交流吗？**

>[!note]
>**用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可**



### 7.8.2 特殊功能调用

* #### 概述

模块内置一些特殊功能，可在人机对话交互过程中由用户发言调用。用户可参考如下表述，向WonderLLM模块下达指令，查询当前支持的全部特殊功能：**①你能做什么**  **②介绍一下你的功能**，下表已列出当前模块支持的特殊功能：
>[!note]
>**1.用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可**
>
>**2.如若用户向模块注册自定义MCP工具，也可以使用以上方式查询已注册的MCP工具，以此判断注册是否成功，相关操作详见“2.进阶课程”。**

| 序号 | 功能     | 序号 | 功能   |
| ---- | -------- | ---- | ------ |
| 1    | 查天气   | 4    | 讲笑话 |
| 2    | 播报新闻 | 5    | 查黄历 |
| 3    | 穿搭建议 | 6    | 放音乐 |


* #### 调用示例

1)  用户可参考下文表述，向WonderLLM模块下达指令，调用对应特殊功能。
>[!note]
>**用户表达语句不需要严格遵循给出示例，只需要保证表意相同即可**

2. 查天气功能：**帮我查询一下xx地区的天气情况**。

<img src="..\_static\media\chapter_7\section_3\media\image4.png"    class="common_img"  style="width:400px"/>

3. 播报新闻功能：**①播报一下今天的新闻**  **②介绍一下今天的热点事件**。

<img src="..\_static\media\chapter_7\section_3\media\image3.png"    class="common_img"  style="width:400px"/>

4. 穿搭建议功能：**我今天出门适合怎样搭配衣物呢**。

<img src="..\_static\media\chapter_7\section_3\media\image9.png"    class="common_img"  style="width:400px"/>

5. 讲笑话功能：**①给我讲个笑话吧**  **②能说个笑话逗逗我吗**。

<img src="..\_static\media\chapter_7\section_3\media\image6.png"    class="common_img"  style="width:400px"/>

6. 查黄历功能：**查询一下今日的黄历事项**。

<img src="..\_static\media\chapter_7\section_3\media\image7.png"    class="common_img"  style="width:400px"/>

7. 放音乐功能：**①播放一首音乐吧(在后续的对话中，需要指定歌手和歌曲名)**  **②播放（xx的）《xxx》**。

<img src="..\_static\media\chapter_7\section_3\media\image8.png"    class="common_img"  style="width:400px"/>

>[!note]
>**音乐曲库来自于大模型自带资源库，不支持外部导入，未入库歌曲将无法播放。**

<p id ="anther1.9"></p>

## 7.9 **场景理解**

>[!note]
>
>**在进行本节学习前，请确保已根据[“7.1 WonderLLM介绍”](#_7-1-wonderllm介绍)、[“7.2 联网及配置”](#_7-2-联网及配置)打开模块并完成WIFI、智能体配置。**

WonderLLM模块内置高清摄像头，支持捕获实时画面并结合视觉大模型对其进行分析，从而实现模块与外界环境的深层交互，用户可通过如下方式体验该玩法。

### 7.9.1 语音交互控制

1)  模块上电后，进入表情界面，此时通过说出唤醒词/短按右侧按键进入聊天界面激活模块。

<img src="../_static\media/chapter_7/section_1/media/image1.png" style="width:400px"  class="common_img" />

2)  用户可参考如下表述，向WonderLLM模块下达指令：**①描述一下你前方看到的东西**  **②请拍一张照片**

>[!note]
>
>**用户表达语句不需要严格遵循上文给出示例，只需要保证表意相同即可**

3)  模块理解用户指令后，模块摄像头启动捕获一张实时图像并短时间显示在屏幕上供用户确认，对话框返回需调用的图像捕获函数（用户无需关注），之后对话框显示大模型对图像的分析语句并同步播报。（回复语句为大模型模块随机生成，仅保证表意恰当）

>[!note]
>
>**模块在场景理解功能中，不支持长时间观测，只能在用户下达指令开启该功能后，捕获一张实时图像并对其进行分析。**

<img src="../_static\media/chapter_7/section_4/media/image2.png" style="width:400px"  class="common_img" />



### 7.9.2 屏幕触摸触发

1. 模块上电后，进入表情界面。

   <img src="../_static\media/chapter_7/section_1/media/image1.png" style="width:400px"  class="common_img" />

2. 在表情界面下，双击屏幕任一位置，模块进入摄像头模式，此时屏幕实时显示当前摄像头捕获到的前方画面。

   <img src="../_static\media/chapter_7/section_4/media/image2.png" style="width:400px"  class="common_img" />

3. 在摄像头模式下，再单击屏幕任一位置，模块摄像头截取一张实时图像并短时间显示在屏幕上供用户确认，之后恢复至摄像头模式，模块自动播报对图像的分析语句。（回复语句为大模型模块随机生成，仅保证表意恰当）

>[!note]
>
>* **在摄像头模式下，再次双击即可返回表情界面。**
>* **在用户在摄像头模式单击触发前，模块仅通过摄像头捕获实时画面并显示在屏幕上，不会调用大模型对其进行分析。**


## 7.10 **唤醒词修改**
<p id = 'p7-10'></p>

### 7.10.1 CI1302固件制作

CI1302芯片在WonderLLM模块中承担识别唤醒词的任务，客户若想要以新的昵称来唤醒模块，需要制作一份新的CI1302固件并烧录，本小节将具体讲解固件制作流程。

* #### 唤醒词固件制作

>[!note]
>**我们以唤醒词“HELLO-HIWONDER”为例，进行固件制作，操作步骤也一致适用于中文唤醒词制作。（英文的唤醒词设置必须为大写才可生效）**

1. 首先需要打开“[<u>启英泰伦语音AI平台 (chipintelli.com)</u>](https://aiplatform.chipintelli.com/home/index.html) ”链接，进入固件制作官网。

2. 点击菜单栏的“**平台功能**”，再点击产品开发栏下的“**产品固件及SDK深度开发**”。

   <img src="../_static\media/chapter_7/section_7/media/image1_1.png"   class="common_img" />

3. 此时系统将提示需要登录账号（若未注册需先完成平台账号注册）。本文示例中我们已提前完成注册，登录成功后请先点击“**离线语音识别大模型应用**”。

<img src="../_static\media/chapter_7/section_7/media/image2_1.png"   class="common_img" />

4. 在子菜单中再点击**“产品固件及SDK深度开发”**入口。

   <img src="../_static\media/chapter_7/section_7/media/image3_1.png"   class="common_img" />

5. 当页面跳转后，在左侧点击<img src="../_static\media/chapter_7/section_7/media/image4_1.png"  class="inline-icon"/>，按照下图新建一个产品，其中产品名称和描述可自定义，应用方案需要选择“**单麦语音识别**”。

<img src="../_static\media/chapter_7/section_7/media/image5_1.png"   class="common_img" />

6. 在弹出的参数项中，产品类型选择“**通用-\>智能中控**”，芯片型号选择“**CI1302**”。之后继续弹出sdk名称，这里选择“**CI13XX_SDK_ASR_Offline**。

7. 在随后弹出的sdk版本选项选择“**1.12.16**”，描述可随意填写，完成全部选项配置后，点击“**创建**”。

   <img src="../_static\media/chapter_7/section_7/media/image6_1.png"   class="common_img" />

8. 接下来填写项目的基本信息，我们需要识别英文，那么语言类型选择“**英文**”（**识别中文只需要“语音类型”选择及“选择声学模型”选为中文即可）**，其余信息按照下图选择，完成后点击“**继续**”。

   <img src="../_static\media/chapter_7/section_7/media/image7.png"   class="common_img" />

   识别语音为中文时，可按如下方式配置：

   <img src="../_static\media/chapter_7/section_7/media/image8.png"   class="common_img" />

9. 进入固件配置界面后，我们将重点说明关键参数的修改步骤。首先，在算法参数设置中启用"**回声消除**"功能。

   <img src="../_static\media/chapter_7/section_7/media/image9.png"   class="common_img" />

10. 在硬件参数中，需要将晶振源选择为“**内部RC**”，同时需要关闭波特率校准功能。

    <img src="../_static\media/chapter_7/section_7/media/image10.png"   class="common_img" />

11. 在打印串口配置中，将UART0电平配置为开漏功能，支持外部上拉5V。

    <img src="../_static\media/chapter_7/section_7/media/image11.png"   class="common_img" />

12. 对通讯串口配置进行修改，设置波特率为115200，并配置UART1电平为开漏功能，支持外部上拉5V，配置完成后点击“**继续**”进入下一步。

    <img src="../_static\media/chapter_7/section_7/media/image12.png"   class="common_img" />

13. 下面进入到编辑命令词功能中，首先需要选择播放的音色，这里我们选择“**Dane-英语男声**”。**（如果是中文的话也可以选择程程-标准男童 Ver.1）**

>[!note]
>
>* **此处的音色并不是WonderLLM模块与用户交互发言时的音色(如需调节，请前往小智AI平台控制台，在绑定当前模块设备ID的智能体中调节，详见[7.2 联网及配置](#_7-2-联网及配置)，之后重启设备即可生效)。**
>* **在后面的应用中并不会使用CI1302的播报功能，因此用户随意选择即可。**

<img src="../_static\media/chapter_7/section_7/media/image13.png"   class="common_img" />

<img src="../_static\media/chapter_7/section_7/media/image14.png"   class="common_img" />

14. 接着我们将命令词附件进行上传，找到“**命令词播报词协议列表V3_英文模板**”表格(路径：“**1.10 唤醒词修改\1.10.2 命令词播报词协议列表**”，直接拖入到网页中进行上传。（本步骤以英文版本进行介绍，中文版本请见下文“**中文唤醒词制作**”）

>[!note]
>**如果要修改唤醒词可打开（[命令词播报词协议列表V3_英文模板](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)表格，将里面的“HELLO-HIWONDER"修改成自己需要的唤醒词。（英文版本的唤醒词只能使用英文的唤醒，无法中英文共用，并且英文的唤醒词要大写才生效）**。

<img src="../_static\media/chapter_7/section_7/media/image15.png"   class="common_img" />
    
<img src="../_static\media/chapter_7/section_7/media/image16.png"   class="common_img" />

15. 上传文件后，即可在下方的表格中看到我们的命令词数据，滑动至页面最下方，点击“**立即提交**”。

>[!note]
>**我们在实践中仅使用CI1302词条列表中的“唤醒词”词条，其他未使用词条客户无需关注。**

<img src="../_static\media/chapter_7/section_7/media/image17.png"   class="common_img" />

16. 提交后等待几分钟即可完成固件制作，完成后点击“**下载固件**”即可获取到制作的固件了。

    <img src="../_static\media/chapter_7/section_7/media/image18.png"   class="common_img" />

17. 固件下载完成，得到一个压缩包，解压后内部存放一个.bin格式文件，后续我们将使用专用固件烧录工具将其烧录至CI1302芯片。

    

* #### 中文唤醒词制作

我们以**“小幻，小幻”**为例，找到**“命令词播报词协议列表V3_中文模板”**表格(路径：[“**1.10 唤醒词修改\1.10.2 命令词播报词协议列表**”](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2))，直接拖入到网页中进行上传。
>[!note]
>**如果要修改唤醒词可打开“（小幻小幻）命令词播报词协议列表V3_中文模板”表格，将里面的“小幻小幻”修改成自己需要的唤醒词，然后重复（15)、(16)的步骤即可。**

<img src="../_static\media/chapter_7/section_7/media/image19.png"   class="common_img" />

<img src="../_static\media/chapter_7\section_7/media/image20.png"   class="common_img" />



### 7.10.2 命令词播报词协议列表

[7.10.2 命令词播报词协议列表](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)



### 7.10.3 CI1302固件烧录方法

本节课学习烧录固件到 WonderLLM模块当中。

* #### 固件烧录

1. 首先将 WonderLLM下方Type-C接口通过USB数据线连接至电脑。

   <img src="../_static\media/chapter_7/section_7/media/image21.png"   class="common_img" style="width:400px"/>
   
2. 打开本文同路径“**固件烧录工具**”下的“**PACK_UPDATE_TOOL.exe**”文件，选择“**CI1302**”芯片，然后点击“**固件升级**”。

   <img src="../_static\media/chapter_7/section_7/media/image1.png"   class="common_img" />
>[!note]
>**我们以烧录“hello hiwonder固件（唤醒词：hello hiwonder）”为例，操作步骤也一致适用于中文唤醒词烧录。**

3. 点击“**选择固件**”，找到前文步骤中下载解压的.bin固件。

   <img src="../_static\media/chapter_7/section_7/media/image2.png"   class="common_img" />

4. 找到相应的串口，并单击选择。

   <img src="../_static\media/chapter_7/section_7/media/image3.png"   class="common_img" />

5. 接着**同时按下**WonderLLM模块左右两个按键，即可进入到烧录中，等待烧录成功即可。

<img src="../_static\media/chapter_7/section_7/media/image22.png"   class="common_img" style="width:400px"/>


<img src="../_static\media/chapter_7/section_7/media/image4.png"   class="common_img" />



* #### 唤醒测试

当烧录好固件之后，重启模块，等待模块完成网络配置，进入表情界面后，说出新固件唤醒词，若模块蜂鸣器鸣响一声，并进入聊天界面，语音回复问好语句，则表示唤醒词修改成功。



* #### 扩展延伸

1. 为了保证交互流程的统一，用户可将交互过程中模块绑定智能体的昵称同步进行修改。

2. 进入小智AI平台：xiaozhi.me,也可点击[**<u>小智 AI 聊天机器人</u>**](https://xiaozhi.me/)超链接直接访问。进入控制台，选择模块绑定的智能体，选择“**配置角色**”，将助手昵称同步修改为新设定唤醒词，点击“**保存**”并重启设备即可。

   <img src="../_static\media/chapter_7/section_7/media/image5.png"   class="common_img" />
   <img src="../_static\media/chapter_7\section_7/media/image6.png"   class="common_img" />

### 7.10.4 CI1302固件烧录工具

[7.10.4 CI1302固件烧录工具](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)



### 7.10.5 出厂固件

[7.10.5 出厂固件](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)



## 7.11 **固件下载**

### 7.11.1 固件下载

* #### 概述

WonderLLM大模型模块ESP32主控支持程序固件二次烧录，用户可灵活选择课程资料提供的我司出厂固件(**WonderLLM.bin**)、小智AI开源程序固件(**hiwonder_xiaozhi.bin**)进行烧录体验。后续用户也可结合小智AI开源代码进行二次开发并上传至本模块验证测试。
>[!note]
>
>* **固件重新烧录后，需要重新配置WIFI连接信息，操作方法请见[“7.2 联网及配置”](#_7-2-联网及配置)。**
>* **关于“小智AI开源程序固件”的使用说明，详见 “2.进阶开发\2.5 小智开源程序”。**



* #### 设备连接

将WonderLLM大模型模块上方Type-C接口通过USB线接入电脑，如下图。

<img src="../_static\media/chapter_7/section_8/media/image10.png"   class="common_img" style="width:400px"/>




* #### 操作流程

1. 请打开[7.11.2 ESP32固件烧录工具\flash_download_tool_3.9.7](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)压缩包里面的**flash_download_tool_3.9.7.exe**文件。

   <img src="../_static\media/chapter_7/section_8/media/image1.png"   class="common_img" />

2. 选择Chip Type为**ESP32-S3**，其他保持默认，然后点击OK。

   <img src="../_static\media/chapter_7/section_8/media/image2.png"   class="common_img" />

3. 工具打开后，点击**“...”**选择需要烧录的程序bin文件（存放路径：[“7.11 固件下载\7.10.3 ESP32S3固件”](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)）。下面以我司出厂固件WonderMind.bin为例：

   <img src="../_static\media/chapter_7/section_8/media/image3.png"   class="common_img" />

   <img src="../_static\media/chapter_7/section_8/media/image4.png"   class="common_img" />

4. 左侧需打勾，其余配置按照下图所示进行配置即可，COM端口号选择模块所占的端口号。
>[!note]
>**如果您按下图的配置，将SPI MODE设置为DIO，烧录固件后模块无法正常工作；请尝试将SPI MODE设置为DOUT并再次烧录。**

<img src="../_static\media/chapter_7/section_8/media/image5.png"   class="common_img" />

5. 先点击**"ERASE"**擦除之前下载的固件(一定要进行)，等待状态栏显示“**FINISH完成**”。

   <img src="../_static\media/chapter_7/section_8/media/image6.png"   class="common_img" />

   <img src="../_static\media/chapter_7/section_8/media/image7.png"   class="common_img" />

6. 再点击"**START**"下载刚刚选择的固件，等待进度条加载完成，即完成固件下载。

<img src="../_static\media/chapter_7/section_8/media/image8.png"   class="common_img" />

<img src="../_static\media/chapter_7/section_8/media/image9.png"   class="common_img" />

7. 下载完成后，重新拔插数据线，设备重新上电后，即根据新固件程序开始工作。

   

### 7.11.2 ESP32固件烧录工具

[7.11.2 ESP32固件烧录工具](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)



### 7.11.3 ESP32S3固件

[7.11.3 ESP32S3固件](https://pan.baidu.com/s/1dEzSQH2UxW_UqMbu0DZ-Dg?pwd=upx2)
